(()=>{"use strict";var e={1444:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Me});var o=r(7225),n=r(6665),a=r(3668),l=r(3929),i=r(2190),s=r(3986),u=r(467),c=r(6283),d=r(1690),f=r(5648),g=a.default.create({container:{flex:1,justifyContent:"center",padding:16},titleLogIn:{fontSize:20,fontWeight:"bold",textAlign:"center",color:"black",paddingBlock:10},titleHeader:{color:"black",fontSize:20,fontWeight:"bold",paddingVertical:12},containerheader:{justifyContent:"center",width:"100%",alignItems:"center",paddingVertical:12},separator:{height:1,backgroundColor:"black",width:"100%",marginTop:12},input:{borderColor:"black",borderWidth:1,borderRadius:5,padding:10,marginBottom:10},recoveryText:{color:"blue",textAlign:"left",marginTop:16},privacyText:{color:"blue",textAlign:"left",marginTop:16},button:{backgroundColor:"#414BB2",padding:10,borderRadius:5,alignItems:"center",marginTop:16,width:"100%"},buttonText:{color:"white",fontWeight:"bold"},secondaryButton:{backgroundColor:"transparent",borderColor:"#414BB2",borderWidth:1,padding:10,borderRadius:5,alignItems:"center",marginTop:16,width:"100%"},secondaryButtonText:{color:"#414BB2",fontWeight:"bold"},appBar:{flexDirection:"row",justifyContent:"space-around",padding:5,backgroundColor:"#414BB2",marginTop:10},appBarText:{color:"white",fontWeight:"bold"}}),m=r(397);const p=function(e){var t=e.title,r=e.onPress,o=e.type,n=void 0===o?"primary":o,a="primary"===n?g.button:g.secondaryButton,l="primary"===n?g.buttonText:g.secondaryButtonText;return(0,m.jsx)(f.default,{style:a,onPress:r,children:(0,m.jsx)(c.default,{style:l,children:t})})};var h=a.default.create({containerPage:{flex:1,backgroundColor:"white",width:"100%"},headerContainer:{minHeight:50,width:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"white",paddingTop:12},contentBody:{flex:1,marginTop:5,marginBottom:5,padding:20,width:"100%"},body:{flex:1,justifyContent:"center",alignItems:"center"},footer:{marginTop:20,flex:.1,justifyContent:"center",alignItems:"center"},buttonContainer:{justifyContent:"center",alignItems:"center",padding:20}});const b=function(e){var t=e.header,r=e.body,o=e.buttons,n=e.footer;return(0,m.jsxs)(l.default,{style:h.containerPage,children:[(0,m.jsx)(l.default,{style:h.headerContainer,children:t}),(0,m.jsx)(l.default,{style:h.contentBody,children:(0,m.jsx)(l.default,{style:h.body,children:r})}),(0,m.jsx)(l.default,{style:h.buttonContainer,children:o}),(0,m.jsx)(l.default,{style:h.footer,children:n})]})};const y=function(e){var t=e.titleName;return(0,m.jsxs)(l.default,{style:g.containerheader,children:[(0,m.jsx)(c.default,{style:g.titleHeader,children:t}),(0,m.jsx)(l.default,{style:g.separator})]})};var x=r(2852),j="localhost"===window.location.hostname?"http://localhost:3001/api":"https://bitacoraapp.onrender.com/api",v="PROD V1.3",C=a.default.create({centered:{alignItems:"center",justifyContent:"center"},title:{fontSize:32,marginBottom:10}});const S=function(){var e=(0,s.useNavigate)();n.useEffect((function(){document.title=`Bit\xe1cora App ${v}`,console.log("=== Bit\xe1cora App ==="),console.log(`Versi\xf3n: ${v}`),console.log("===================")}),[]);var t=function(){var e=(0,u.default)((function*(){try{if(console.log("=== Verificando estado del servidor ==="),(yield fetch(`${j}/bitacoras`)).ok)return console.log("\u2705 Servidor funcionando correctamente"),!0}catch(e){return console.log("\u274c Servidor no est\xe1 funcionando"),console.log("=== Instrucciones para iniciar el servidor ==="),console.log("1. Abre una terminal nueva"),console.log("2. Navega al directorio del backend:"),console.log("   cd BITACORABACKEND"),console.log("3. Inicia el servidor:"),console.log("   node src/server.js"),console.log(`4. Espera a ver el mensaje: "Servidor corriendo en ${j}"`),!1}}));return function(){return e.apply(this,arguments)}}(),r=function(){var r=(0,u.default)((function*(){(yield t())?e("/newBitacora"):d.default.alert("Servidor no disponible","El servidor backend no est\xe1 funcionando. Por favor, inicia el servidor antes de continuar.",[{text:"Entendido",style:"cancel"}])}));return function(){return r.apply(this,arguments)}}();return(0,m.jsx)(b,{header:(0,m.jsx)(y,{titleName:"Bienvenido"}),body:(0,m.jsxs)(l.default,{style:C.centered,children:[(0,m.jsx)(c.default,{style:C.title,children:"Bit\xe1cora App"}),(0,m.jsx)(x.default,{name:"airplane",size:50,color:"black"})]}),buttons:(0,m.jsx)(p,{title:"Iniciar",onPress:r}),footer:(0,m.jsx)(l.default,{children:(0,m.jsx)(c.default,{})})})};var T=r(4467),O=r(6773),w=r(5410),E=r(9201);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=E.object().shape({tipoAeronave:E.string().required("El tipo de aeronave es requerido").min(2,"El tipo de aeronave debe tener al menos 2 caracteres"),matricula:E.string().required("La matr\xedcula es requerida").matches(/^[A-Z0-9-]+$/,"La matr\xedcula solo debe contener letras may\xfasculas, n\xfameros y guiones"),organismo:E.string().required("El organismo es requerido").min(2,"El organismo debe tener al menos 2 caracteres"),folio:E.string().matches(/^\d{4}-\d{3}$/,"El folio debe tener el formato YYYY-XXX (ejemplo: 2024-001)").nullable().optional()}),B=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},inputGroup:{marginBottom:10,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:2},buttonText:{color:"white"}});const A=function(){var e=(0,s.useNavigate)(),t=function(){var t=(0,u.default)((function*(t){try{console.log("=== NewBitacora - Intentando crear bit\xe1cora ==="),console.log("Datos a enviar:",t);var r=yield fetch(`${j}/bitacora`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I(I({},t),{},{folio:t.folio||""}))});if(!r.ok){var o=yield r.json();if("Ya existe una bit\xe1cora con esta matr\xedcula"===o.error)return void d.default.alert("Matr\xedcula duplicada","Ya existe una bit\xe1cora con esta matr\xedcula. Por favor, verifica la matr\xedcula e intenta nuevamente.",[{text:"Entendido",style:"cancel"}]);throw new Error(o.error||"Error al guardar los datos")}var n=yield r.json();console.log("=== NewBitacora - Bit\xe1cora creada exitosamente ==="),console.log("ID recibido del backend:",n._id),console.log("Matr\xedcula:",t.matricula),d.default.alert("\xc9xito","Bit\xe1cora creada exitosamente"),e("/InfoFlight",{state:{folio:t.folio||"",bitacoraId:n._id,matricula:t.matricula}}),console.log("=== NewBitacora - Despu\xe9s de navegar ==="),console.log("Estado de navegaci\xf3n enviado:",{folio:t.folio||"",bitacoraId:n._id,matricula:t.matricula})}catch(a){console.error("Error completo:",a),d.default.alert("Error",a.message||"Hubo un problema al guardar los datos")}}));return function(e){return t.apply(this,arguments)}}();return(0,m.jsx)(b,{header:(0,m.jsx)(y,{titleName:"Nueva Bit\xe1cora"}),body:(0,m.jsx)(w.Formik,{initialValues:{tipoAeronave:"",matricula:"",organismo:"",folio:""},validationSchema:D,onSubmit:t,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,a=e.errors,i=e.touched;return(0,m.jsxs)(l.default,{style:B.body,children:[(0,m.jsxs)(l.default,{style:B.inputGroup,children:[(0,m.jsx)(c.default,{style:B.label,children:"Tipo de Aeronave"}),(0,m.jsx)(O.default,{style:[B.input,i.tipoAeronave&&a.tipoAeronave&&B.inputError],onChangeText:t("tipoAeronave"),onBlur:r("tipoAeronave"),value:n.tipoAeronave,placeholder:"Ej: Bell 412"}),i.tipoAeronave&&a.tipoAeronave&&(0,m.jsx)(c.default,{style:B.errorText,children:a.tipoAeronave})]}),(0,m.jsxs)(l.default,{style:B.inputGroup,children:[(0,m.jsx)(c.default,{style:B.label,children:"Matr\xedcula"}),(0,m.jsx)(O.default,{style:[B.input,i.matricula&&a.matricula&&B.inputError],onChangeText:t("matricula"),onBlur:r("matricula"),value:n.matricula,placeholder:"Ej: 1213"}),i.matricula&&a.matricula&&(0,m.jsx)(c.default,{style:B.errorText,children:a.matricula})]}),(0,m.jsxs)(l.default,{style:B.inputGroup,children:[(0,m.jsx)(c.default,{style:B.label,children:"Organismo"}),(0,m.jsx)(O.default,{style:[B.input,i.organismo&&a.organismo&&B.inputError],onChangeText:t("organismo"),onBlur:r("organismo"),value:n.organismo,placeholder:"Ej: SEDENA"}),i.organismo&&a.organismo&&(0,m.jsx)(c.default,{style:B.errorText,children:a.organismo})]}),(0,m.jsxs)(l.default,{style:B.inputGroup,children:[(0,m.jsx)(c.default,{style:B.label,children:"Folio"}),(0,m.jsx)(O.default,{style:[B.input,i.folio&&a.folio&&B.inputError],onChangeText:t("folio"),onBlur:r("folio"),value:n.folio,placeholder:"Ej: 2024-001"}),i.folio&&a.folio&&(0,m.jsx)(c.default,{style:B.errorText,children:a.folio})]}),(0,m.jsx)(p,{title:(0,m.jsx)(c.default,{style:B.buttonText,children:"Continuar"}),onPress:o})]})}}),footer:(0,m.jsx)(l.default,{children:(0,m.jsx)(c.default,{})})})};var F=r(296),k=r(4307),N=a.default.create({containerPage:{flex:1,backgroundColor:"white",width:"100%"},headerContainer:{minHeight:50,width:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"white",paddingTop:12},contentBody:{flex:1,marginTop:5,marginBottom:5,padding:20,width:"100%"},body:{flex:1,justifyContent:"center",alignItems:"center"},footer:{marginTop:20,flex:.1,justifyContent:"center",alignItems:"center"},buttonContainer:{justifyContent:"center",alignItems:"center",padding:20}});const R=function(e){var t=e.header,r=e.body,o=e.buttons,n=e.footer;return(0,m.jsxs)(l.default,{style:N.containerPage,children:[(0,m.jsx)(l.default,{style:N.headerContainer,children:t}),(0,m.jsx)(k.default,{style:N.contentBody,children:(0,m.jsx)(l.default,{style:N.body,children:r})}),(0,m.jsx)(l.default,{style:N.buttonContainer,children:o}),(0,m.jsx)(l.default,{style:N.footer,children:n})]})};var L=a.default.create({container:{width:"100%",marginBottom:10},label:{textAlign:"left",marginBottom:5},buttonGroup:{flexDirection:"row",justifyContent:"space-between",width:"100%"},button:{flex:1,backgroundColor:"white",padding:10,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:"gray",marginHorizontal:2},selectedButton:{backgroundColor:"black"},buttonText:{color:"black"},selectedButtonText:{color:"white"}});const z=function(e){var t=e.onSelect,r=e.title,o=(0,n.useState)(null),a=(0,F.default)(o,2),i=a[0],s=a[1];return(0,m.jsxs)(l.default,{style:L.container,children:[(0,m.jsx)(c.default,{style:L.label,children:r}),(0,m.jsx)(l.default,{style:L.buttonGroup,children:["A","B","C","D"].map((function(e){return(0,m.jsx)(f.default,{style:[L.button,i===e&&L.selectedButton],onPress:function(){return function(e){s(e),t&&t(e)}(e)},children:(0,m.jsx)(c.default,{style:[L.buttonText,i===e&&L.selectedButtonText],children:e})},e)}))})]})};var G=r(2098),q=(r(7239),a.default.create({container:{width:"100%"},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:5},webDatePicker:{width:"100%",height:40,borderColor:"gray",borderWidth:1,borderRadius:4,padding:8},webDatePickerWrapper:{width:"100%"}}));const V=function(e){var t=e.value,r=e.onChange,o=e.error,a=e.touched,i=(0,n.useState)(t?new Date(t):new Date),s=(0,F.default)(i,2),u=s[0],d=s[1];return(0,m.jsxs)(l.default,{style:q.container,children:[(0,m.jsx)(G.default,{selected:u,onChange:function(e){if(d(e),e){var t=e.toISOString().split("T")[0];r(t)}},dateFormat:"yyyy-MM-dd",className:q.webDatePicker,wrapperClassName:q.webDatePickerWrapper}),o&&a&&(0,m.jsx)(c.default,{style:q.errorText,children:o})]})};function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $=E.object().shape({lugarSalida:E.string().required("El lugar de salida es requerido").min(2,"El lugar de salida debe tener al menos 2 caracteres"),lugarLlegada:E.string().required("El lugar de llegada es requerido").min(2,"El lugar de llegada debe tener al menos 2 caracteres"),tipoVuelo:E.string().required("El tipo de vuelo es requerido").min(2,"El tipo de vuelo debe tener al menos 2 caracteres"),eventosTorque:E.string().required("Los eventos de torque son requeridos"),cargaAceiteMotores:E.string().matches(/^\d+(\.\d+)?$/,"Debe ser un n\xfamero v\xe1lido").nullable().optional(),cargaAceiteAPU:E.string().matches(/^\d+(\.\d+)?$/,"Debe ser un n\xfamero v\xe1lido").nullable().optional(),fechaInfoFlight:E.string().required("La fecha es requerida").matches(/^\d{4}-\d{2}-\d{2}$/,"La fecha debe tener el formato YYYY-MM-DD"),categoria:E.string().required("La categor\xeda es requerida"),observaciones:E.string().max(500,"Las observaciones no pueden exceder los 500 caracteres")}),U=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},inputGroup:{marginBottom:10,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},observacionesInput:{height:80,textAlignVertical:"top",paddingTop:8},buttonText:{color:"white"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:2}});const _=function(){var e,t,r,o,a,i,f,g,h,b,x,v,C,S,T,E,P,I,D=(0,s.useNavigate)(),B=(0,s.useLocation)(),A=n.useState(new Date),k=(0,F.default)(A,1)[0];n.useEffect((function(){var e,t;console.log("=== InfoFlight - Al recibir el estado ==="),console.log("Estado recibido:",B.state),console.log("Datos de vuelo recibidos:",null==(e=B.state)?void 0:e.flightData),console.log("Matr\xedcula recibida:",null==(t=B.state)?void 0:t.matricula)}),[B.state]);var N=function(){var e=(0,u.default)((function*(e){try{var t,r=null==(t=B.state)?void 0:t.matricula;if(!r)throw new Error("No se encontr\xf3 la matr\xedcula de la bit\xe1cora");console.log("=== InfoFlight - Antes de actualizar ==="),console.log("Matr\xedcula de la bit\xe1cora:",r),console.log("Datos a enviar:",e);var o=yield fetch(`${j}/bitacora/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M(M({},e),{},{observacionesInfoFlight:e.observaciones}))});if(console.log("Respuesta del servidor:",o.status),!o.ok){var n=yield o.json();throw new Error(n.error||"Error al actualizar los datos")}var a=yield o.json();console.log("=== InfoFlight - Despu\xe9s de actualizar ==="),console.log("Datos actualizados:",a),d.default.alert("\xc9xito","Datos de vuelo guardados exitosamente"),console.log("=== InfoFlight - Antes de navegar ==="),console.log("Estado a enviar:",{flightData:e,matricula:r}),D("/InfoFlightPt2",{state:{flightData:e,matricula:r}})}catch(l){console.error("Error completo:",l),d.default.alert("Error",l.message||"Hubo un problema al guardar los datos")}}));return function(t){return e.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Informaci\xf3n de Vuelo"}),body:(0,m.jsx)(w.Formik,{initialValues:{lugarSalida:(null==(e=B.state)||null==(t=e.flightData)?void 0:t.lugarSalida)||"",lugarLlegada:(null==(r=B.state)||null==(o=r.flightData)?void 0:o.lugarLlegada)||"",tipoVuelo:(null==(a=B.state)||null==(i=a.flightData)?void 0:i.tipoVuelo)||"",eventosTorque:(null==(f=B.state)||null==(g=f.flightData)?void 0:g.eventosTorque)||"",cargaAceiteMotores:(null==(h=B.state)||null==(b=h.flightData)?void 0:b.cargaAceiteMotores)||"",cargaAceiteAPU:(null==(x=B.state)||null==(v=x.flightData)?void 0:v.cargaAceiteAPU)||"",fechaInfoFlight:(null==(C=B.state)||null==(S=C.flightData)?void 0:S.fechaInfoFlight)||k.toISOString().split("T")[0],categoria:(null==(T=B.state)||null==(E=T.flightData)?void 0:E.categoria)||"",observaciones:(null==(P=B.state)||null==(I=P.flightData)?void 0:I.observaciones)||""},validationSchema:$,onSubmit:N,enableReinitialize:!0,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,a=e.setFieldValue,i=e.errors,s=e.touched;return(0,m.jsxs)(l.default,{style:U.body,children:[(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Lugar de Salida"}),(0,m.jsx)(O.default,{style:[U.input,s.lugarSalida&&i.lugarSalida&&U.inputError],onChangeText:function(e){t("lugarSalida")(e)},onBlur:r("lugarSalida"),value:n.lugarSalida}),s.lugarSalida&&i.lugarSalida&&(0,m.jsx)(c.default,{style:U.errorText,children:i.lugarSalida})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Lugar de Llegada"}),(0,m.jsx)(O.default,{style:[U.input,s.lugarLlegada&&i.lugarLlegada&&U.inputError],onChangeText:t("lugarLlegada"),onBlur:r("lugarLlegada"),value:n.lugarLlegada}),s.lugarLlegada&&i.lugarLlegada&&(0,m.jsx)(c.default,{style:U.errorText,children:i.lugarLlegada})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Tipo de Vuelo"}),(0,m.jsx)(O.default,{style:[U.input,s.tipoVuelo&&i.tipoVuelo&&U.inputError],onChangeText:t("tipoVuelo"),onBlur:r("tipoVuelo"),value:n.tipoVuelo}),s.tipoVuelo&&i.tipoVuelo&&(0,m.jsx)(c.default,{style:U.errorText,children:i.tipoVuelo})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Eventos de Torque"}),(0,m.jsx)(O.default,{style:[U.input,s.eventosTorque&&i.eventosTorque&&U.inputError],onChangeText:t("eventosTorque"),onBlur:r("eventosTorque"),value:n.eventosTorque}),s.eventosTorque&&i.eventosTorque&&(0,m.jsx)(c.default,{style:U.errorText,children:i.eventosTorque})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Carga Aceite Motores"}),(0,m.jsx)(O.default,{style:[U.input,s.cargaAceiteMotores&&i.cargaAceiteMotores&&U.inputError],onChangeText:t("cargaAceiteMotores"),onBlur:r("cargaAceiteMotores"),value:n.cargaAceiteMotores}),s.cargaAceiteMotores&&i.cargaAceiteMotores&&(0,m.jsx)(c.default,{style:U.errorText,children:i.cargaAceiteMotores})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Carga Aceite A.P.U."}),(0,m.jsx)(O.default,{style:[U.input,s.cargaAceiteAPU&&i.cargaAceiteAPU&&U.inputError],onChangeText:t("cargaAceiteAPU"),onBlur:r("cargaAceiteAPU"),value:n.cargaAceiteAPU}),s.cargaAceiteAPU&&i.cargaAceiteAPU&&(0,m.jsx)(c.default,{style:U.errorText,children:i.cargaAceiteAPU})]}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Fecha"}),(0,m.jsx)(V,{value:n.fechaInfoFlight,onChange:function(e){return a("fechaInfoFlight",e)},error:s.fechaInfoFlight&&i.fechaInfoFlight,touched:s.fechaInfoFlight}),s.fechaInfoFlight&&i.fechaInfoFlight&&(0,m.jsx)(c.default,{style:U.errorText,children:i.fechaInfoFlight})]}),(0,m.jsx)(z,{title:"Categoria",onSelect:function(e){console.log("Categor\xeda seleccionada:",e),a("categoria",e)},error:s.categoria&&i.categoria}),s.categoria&&i.categoria&&(0,m.jsx)(c.default,{style:U.errorText,children:i.categoria}),(0,m.jsxs)(l.default,{style:U.inputGroup,children:[(0,m.jsx)(c.default,{style:U.label,children:"Observaciones"}),(0,m.jsx)(O.default,{style:[U.input,U.observacionesInput,s.observaciones&&i.observaciones&&U.inputError],onChangeText:t("observaciones"),onBlur:r("observaciones"),value:n.observaciones,multiline:!0,numberOfLines:3})]}),(0,m.jsx)(p,{title:(0,m.jsx)(c.default,{style:U.buttonText,children:"Continuar"}),onPress:function(){console.log("Valores del formulario antes de enviar:",n),o()}})]})}}),footer:(0,m.jsx)(l.default,{children:(0,m.jsx)(c.default,{})})})};var H=a.default.create({smallButton:{width:"48%"}});const Y=function(e){var t=e.title,r=e.onPress,o=e.type,n=void 0===o?"primary":o,a=e.style,l="primary"===n?g.button:g.secondaryButton,i="primary"===n?g.buttonText:g.secondaryButtonText;return(0,m.jsx)(f.default,{style:[l,H.smallButton,a],onPress:r,children:(0,m.jsx)(c.default,{style:i,children:t})})};var J=r(5458),X=a.default.create({container:{width:"100%",marginBottom:10},label:{textAlign:"left",marginBottom:5},inputContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%"},input:{width:"23%",height:40,borderWidth:1,borderColor:"gray",textAlign:"center",fontSize:16}});const Z=function(e){var t=e.onChangeText,r=e.value,o=void 0===r?"":r,a=e.label,i=(0,n.useState)(["","","",""]),s=(0,F.default)(i,2),u=s[0],d=s[1],f=[(0,n.useRef)(null),(0,n.useRef)(null),(0,n.useRef)(null),(0,n.useRef)(null)];n.useEffect((function(){if(o){for(var e=o.split("").slice(0,4);e.length<4;)e.push("");d(e)}}),[o]);var g=function(e,r){e.length>1&&(e=e.charAt(0));var o=(0,J.default)(u);o[r]=e,d(o);var n=o.join("");t(n),e&&r<3&&f[r+1].current.focus()};return(0,m.jsxs)(l.default,{style:X.container,children:[(0,m.jsx)(c.default,{style:X.label,children:a}),(0,m.jsx)(l.default,{style:X.inputContainer,children:u.map((function(e,t){return(0,m.jsx)(O.default,{ref:f[t],style:X.input,value:e,onChangeText:function(e){return g(e,t)},onKeyPress:function(e){return function(e,t){"Backspace"===e.nativeEvent.key&&!u[t]&&t>0&&f[t-1].current.focus()}(e,t)},maxLength:1,autoCapitalize:"characters"},t)}))})]})};var K=E.object().shape({fechaCorreccion:E.string().nullable().optional(),codigoATA:E.string().nullable().optional(),mmReferencia:E.string().nullable().optional(),observaciones:E.string()}),Q=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},subtitle:{fontSize:16,fontWeight:"bold",textAlign:"center",marginBottom:20,width:"100%"},inputGroup:{marginBottom:10,width:"100%"},label:{textAlign:"left",marginBottom:5,fontSize:14},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:2},buttonContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:10}});const ee=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)();n.useEffect((function(){var e,r;console.log("=== InfoFlightPt2 - Al recibir el estado ==="),console.log("Estado recibido:",t.state),console.log("Datos de vuelo recibidos:",null==(e=t.state)?void 0:e.flightData),console.log("Folio recibido:",null==(r=t.state)?void 0:r.folio)}),[t.state]);var r=function(){var r=(0,u.default)((function*(r){try{var o,n,a,l=null==(o=t.state)?void 0:o.matricula;if(!l)throw new Error("No se encontr\xf3 la matr\xedcula de la bit\xe1cora");console.log("=== InfoFlightPt2 - Antes de actualizar ==="),console.log("Matr\xedcula de la bit\xe1cora:",l),console.log("Datos a enviar:",r);var i=yield fetch(`${j}/bitacora/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({correcciones:[{fechaCorreccion:r.fechaCorreccion,codigoATA:r.codigoATA,mmReferencia:r.mmReferencia}],observacionesInfoFlightPt2:r.observaciones})});if(console.log("Respuesta del servidor:",i.status),!i.ok){var s=yield i.json();throw new Error(s.error||"Error al actualizar los datos")}var u=yield i.json();console.log("=== InfoFlightPt2 - Despu\xe9s de actualizar ==="),console.log("Datos actualizados:",u),d.default.alert("\xc9xito","Datos de mantenimiento guardados exitosamente"),console.log("=== InfoFlightPt2 - Antes de navegar ==="),console.log("Estado a enviar:",{flightData:null==(n=t.state)?void 0:n.flightData,maintenanceData:r,matricula:l}),e("/InfoFlightComponents",{state:{flightData:null==(a=t.state)?void 0:a.flightData,maintenanceData:r,matricula:l}})}catch(c){console.error("Error completo:",c),d.default.alert("Error",c.message||"Hubo un problema al guardar los datos")}}));return function(e){return r.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Correcciones/Servicios"}),body:(0,m.jsx)(w.Formik,{initialValues:{fechaCorreccion:(new Date).toISOString().split("T")[0],codigoATA:"",mmReferencia:"",observaciones:""},validationSchema:K,onSubmit:r,children:function(r){var o=r.handleChange,n=r.handleBlur,a=r.handleSubmit,i=r.values,s=r.setFieldValue,u=r.errors,d=r.touched;return(0,m.jsxs)(l.default,{style:Q.body,children:[(0,m.jsx)(c.default,{style:Q.subtitle,children:"Correcciones o Servicios de Mantenimiento"}),(0,m.jsxs)(l.default,{style:Q.inputGroup,children:[(0,m.jsx)(c.default,{style:Q.label,children:"Fecha"}),(0,m.jsx)(V,{value:i.fechaCorreccion,onChange:function(e){return s("fechaCorreccion",e)}}),d.fechaCorreccion&&u.fechaCorreccion&&(0,m.jsx)(c.default,{style:Q.errorText,children:u.fechaCorreccion})]}),(0,m.jsx)(Z,{label:"C\xf3digo A.T.A. (Air Transport Association)",value:i.codigoATA,onChangeText:function(e){return s("codigoATA",e)},error:d.codigoATA&&u.codigoATA}),d.codigoATA&&u.codigoATA&&(0,m.jsx)(c.default,{style:Q.errorText,children:u.codigoATA}),(0,m.jsxs)(l.default,{style:Q.inputGroup,children:[(0,m.jsx)(c.default,{style:Q.label,children:"MM (Referencia Manual de Mantenimiento)"}),(0,m.jsx)(O.default,{style:[Q.input,d.mmReferencia&&u.mmReferencia&&Q.inputError],onChangeText:o("mmReferencia"),onBlur:n("mmReferencia"),value:i.mmReferencia}),d.mmReferencia&&u.mmReferencia&&(0,m.jsx)(c.default,{style:Q.errorText,children:u.mmReferencia})]}),(0,m.jsxs)(l.default,{style:Q.inputGroup,children:[(0,m.jsx)(c.default,{style:Q.label,children:"Observaciones"}),(0,m.jsx)(O.default,{style:Q.input,onChangeText:o("observaciones"),onBlur:n("observaciones"),value:i.observaciones})]}),(0,m.jsxs)(l.default,{style:Q.buttonContainer,children:[(0,m.jsx)(Y,{title:"Previo",onPress:function(){var r,o;return e("/InfoFlight",{state:{matricula:null==(r=t.state)?void 0:r.matricula,flightData:null==(o=t.state)?void 0:o.flightData,isEditing:!0}})},style:{backgroundColor:"#3f51b5"}}),(0,m.jsx)(Y,{title:"Continuar",onPress:a})]})]})}})})};var te=E.object().shape({numeroParte:E.string().nullable().optional(),posicion:E.string().nullable().optional(),numeroSerieOFF:E.string().nullable().optional(),numeroSerieON:E.string().nullable().optional(),nomenclatura:E.string().nullable().optional()}),re=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},inputGroup:{marginBottom:10,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:2},noteContainer:{marginVertical:10,width:"100%"},noteText:{textAlign:"center",fontSize:14,color:"#666"},highlightedText:{color:"#000",fontWeight:"bold",fontSize:16},componentCounter:{textAlign:"center",marginTop:5,color:"#3f51b5",fontWeight:"bold"},savedComponentsText:{textAlign:"center",marginTop:5,color:"#4CAF50",fontSize:12},buttonContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:10}});const oe=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)(),r=(0,n.useState)(1),o=(0,F.default)(r,2),a=o[0],i=o[1],f=(0,n.useState)([]),g=(0,F.default)(f,2),p=g[0],h=g[1];(0,n.useEffect)((function(){var e,r;console.log("=== InfoFlightComponents - Estado inicial ==="),console.log("Estado completo recibido:",t.state),null!=(e=t.state)&&e.componentCount&&i(t.state.componentCount),null!=(r=t.state)&&r.components&&h(t.state.components)}),[t.state]);var b=function(){var r=(0,u.default)((function*(r){try{var o,n,a;console.log("=== InfoFlightComponents - Continuando con el \xfaltimo componente ==="),console.log("Valores del \xfaltimo componente:",r);var l=[].concat((0,J.default)(p),[r]);if(console.log("Todos los componentes guardados:",l),0===l.length)throw new Error("Debe agregar al menos un componente");var i=null==(o=t.state)?void 0:o.matricula;if(console.log("Matr\xedcula obtenida del estado:",i),!i)throw console.error("Estado actual:",t.state),new Error("No se encontr\xf3 la matr\xedcula de la bit\xe1cora");console.log("=== InfoFlightComponents - Enviando datos al servidor ==="),console.log("URL:",`${j}/bitacora/${i}`),console.log("Datos a enviar:",{componentes:l});var s=yield fetch(`${j}/bitacora/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({componentes:l})});if(!s.ok){var u=yield s.json();throw console.error("Error del servidor:",u),new Error(u.message||"Error al actualizar los componentes")}var c=yield s.json();console.log("Respuesta del servidor:",c);var f={componentData:l,matricula:i,flightData:null==(n=t.state)?void 0:n.flightData,maintenanceData:null==(a=t.state)?void 0:a.maintenanceData};console.log("Estado a enviar a la siguiente p\xe1gina:",f),e("/InfoFlightOrders",{state:f})}catch(g){console.error("Error en handleContinue:",g),d.default.alert("Error",g.message||"Hubo un error al guardar los componentes. Por favor, intente nuevamente.")}}));return function(e){return r.apply(this,arguments)}}(),x=function(r,o){console.log("=== InfoFlightComponents - Enviando formulario ==="),console.log("Valores del formulario actual:",r),console.log("Contador de componentes:",a),console.log("Acci\xf3n seleccionada:",o),"create"===o?function(r){if(a<3){var o,n,l;if(console.log(`=== InfoFlightComponents - Creando componente ${a} ===`),console.log("Valores del componente:",r),p.length>=2)return void d.default.alert("Error","No se pueden agregar m\xe1s de 3 componentes");var i=[].concat((0,J.default)(p),[r]);console.log("Lista actualizada de componentes:",i);var s={components:i,componentCount:a+1,folio:null==(o=t.state)?void 0:o.folio,flightData:null==(n=t.state)?void 0:n.flightData,maintenanceData:null==(l=t.state)?void 0:l.maintenanceData};console.log("Nuevo estado a enviar:",s),e("/InfoFlightComponents",{state:s,replace:!0})}}(r):b(r)};return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Componentes involucrados"}),body:(0,m.jsx)(w.Formik,{initialValues:{numeroParte:"",posicion:"",numeroSerieOFF:"",numeroSerieON:"",nomenclatura:""},validationSchema:te,onSubmit:function(e,t){(0,t.setSubmitting)(!1)},children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.values,n=e.errors,i=e.touched;return(0,m.jsxs)(l.default,{style:re.body,children:[(0,m.jsxs)(l.default,{style:re.inputGroup,children:[(0,m.jsx)(c.default,{style:re.label,children:"N/P (Numero de partes del componente afectado)"}),(0,m.jsx)(O.default,{style:[re.input,i.numeroParte&&n.numeroParte&&re.inputError],onChangeText:t("numeroParte"),onBlur:r("numeroParte"),value:o.numeroParte}),i.numeroParte&&n.numeroParte&&(0,m.jsx)(c.default,{style:re.errorText,children:n.numeroParte})]}),(0,m.jsxs)(l.default,{style:re.inputGroup,children:[(0,m.jsx)(c.default,{style:re.label,children:"POS (Posici\xf3n del componente afectado)"}),(0,m.jsx)(O.default,{style:[re.input,i.posicion&&n.posicion&&re.inputError],onChangeText:t("posicion"),onBlur:r("posicion"),value:o.posicion}),i.posicion&&n.posicion&&(0,m.jsx)(c.default,{style:re.errorText,children:n.posicion})]}),(0,m.jsxs)(l.default,{style:re.inputGroup,children:[(0,m.jsx)(c.default,{style:re.label,children:"N/S OFF (Numero de serie del componente afectado)"}),(0,m.jsx)(O.default,{style:[re.input,i.numeroSerieOFF&&n.numeroSerieOFF&&re.inputError],onChangeText:t("numeroSerieOFF"),onBlur:r("numeroSerieOFF"),value:o.numeroSerieOFF}),i.numeroSerieOFF&&n.numeroSerieOFF&&(0,m.jsx)(c.default,{style:re.errorText,children:n.numeroSerieOFF})]}),(0,m.jsxs)(l.default,{style:re.inputGroup,children:[(0,m.jsx)(c.default,{style:re.label,children:"N/S ON (Numero de serie del componente instalado)"}),(0,m.jsx)(O.default,{style:[re.input,i.numeroSerieON&&n.numeroSerieON&&re.inputError],onChangeText:t("numeroSerieON"),onBlur:r("numeroSerieON"),value:o.numeroSerieON}),i.numeroSerieON&&n.numeroSerieON&&(0,m.jsx)(c.default,{style:re.errorText,children:n.numeroSerieON})]}),(0,m.jsxs)(l.default,{style:re.inputGroup,children:[(0,m.jsx)(c.default,{style:re.label,children:"Nomenclatura"}),(0,m.jsx)(O.default,{style:[re.input,i.nomenclatura&&n.nomenclatura&&re.inputError],onChangeText:t("nomenclatura"),onBlur:r("nomenclatura"),value:o.nomenclatura}),i.nomenclatura&&n.nomenclatura&&(0,m.jsx)(c.default,{style:re.errorText,children:n.nomenclatura})]}),(0,m.jsxs)(l.default,{style:re.noteContainer,children:[(0,m.jsxs)(c.default,{style:re.noteText,children:["En caso de ser mas de un componente, se debe repetir el formulario dando click en el bot\xf3n ",(0,m.jsx)(c.default,{style:re.highlightedText,children:"Crear"})," para crear un nuevo componente"]}),(0,m.jsxs)(c.default,{style:re.componentCounter,children:["Componente ",a," de 3"]}),a>1&&(0,m.jsxs)(c.default,{style:re.savedComponentsText,children:["Componentes guardados: ",p.length]})]}),(0,m.jsxs)(l.default,{style:re.buttonContainer,children:[a<3&&(0,m.jsx)(Y,{title:"Crear",onPress:function(){return x(o,"create")},style:{backgroundColor:"#3f51b5"}}),(0,m.jsx)(Y,{title:"Continuar",onPress:function(){return x(o,"continue")},style:{backgroundColor:"#4CAF50"}})]})]})}})})};function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=E.object().shape({ordenTrabajo:E.string().nullable().optional(),ordenSuministro:E.string().nullable().optional(),ordenConcentracion:E.string().nullable().optional(),solicitudComponente:E.string().nullable().optional(),categoriaInfoFlightOrders:E.string().nullable().optional()}),ie=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},inputGroup:{marginBottom:10,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:2},buttonContainer:{width:"100%",marginTop:20}});const se=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)();n.useEffect((function(){var e,r,o,n;console.log("=== InfoFlightOrders - Estado inicial ==="),console.log("Estado completo recibido:",t.state),console.log("Matr\xedcula recibida:",null==(e=t.state)?void 0:e.matricula),console.log("Datos de componentes:",null==(r=t.state)?void 0:r.componentData),console.log("Datos de vuelo:",null==(o=t.state)?void 0:o.flightData),console.log("Datos de mantenimiento:",null==(n=t.state)?void 0:n.maintenanceData)}),[t.state]);var r=function(){var r=(0,u.default)((function*(r){try{var o,n,a=null==(o=t.state)?void 0:o.matricula;if(!a)throw console.error("Error: No se encontr\xf3 la matr\xedcula en el estado:",t.state),new Error("No se encontr\xf3 la matr\xedcula de la bit\xe1cora");console.log("=== InfoFlightOrders - Antes de actualizar ==="),console.log("Matr\xedcula de la bit\xe1cora:",a),console.log("Datos a enviar:",r),console.log("Estado actual completo:",t.state);var l=yield fetch(`${j}/bitacora/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ordenTrabajo:r.ordenTrabajo,ordenSuministro:r.ordenSuministro,ordenConcentracion:r.ordenConcentracion,solicitudComponente:r.solicitudComponente,categoriaInfoFlightOrders:r.categoriaInfoFlightOrders})});if(!l.ok){var i=yield l.json();throw console.error("Error del servidor:",i),new Error("Error al actualizar los datos de \xf3rdenes")}var s=yield l.json();console.log("=== InfoFlightOrders - Despu\xe9s de actualizar ==="),console.log("Respuesta completa del servidor:",s),console.log("Datos de la bit\xe1cora actualizados:",s.bitacora);var u={ordenTrabajo:s.bitacora.ordenTrabajo,ordenSuministro:s.bitacora.ordenSuministro,ordenConcentracion:s.bitacora.ordenConcentracion,solicitudComponente:s.bitacora.solicitudComponente,categoria:s.bitacora.categoria};console.log("Campos actualizados en la base de datos:",u);var c=ae(ae({},t.state),{},{ordersData:r,bitacoraId:s.bitacora._id,formData:ae(ae({},null==(n=t.state)?void 0:n.formData),{},{ordersData:r})});console.log("=== InfoFlightOrders - Estado final ==="),console.log("Estado a enviar a la siguiente p\xe1gina:",c),console.log("BitacoraId a enviar:",s.bitacora._id),e("/signatureIssuing",{state:c})}catch(f){console.error("Error en handleSubmit:",f),d.default.alert("Error",f.message||"Hubo un error al guardar los datos de \xf3rdenes. Por favor, intente nuevamente.")}}));return function(e){return r.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"\xd3rdenes y Solicitudes"}),body:(0,m.jsx)(w.Formik,{initialValues:{ordenTrabajo:"",ordenSuministro:"",ordenConcentracion:"",solicitudComponente:"",categoriaInfoFlightOrders:""},validationSchema:le,onSubmit:r,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,a=e.setFieldValue,i=e.errors,s=e.touched;return(0,m.jsxs)(l.default,{style:ie.body,children:[(0,m.jsxs)(l.default,{style:ie.inputGroup,children:[(0,m.jsx)(c.default,{style:ie.label,children:"Orden de trabajo"}),(0,m.jsx)(O.default,{style:[ie.input,s.ordenTrabajo&&i.ordenTrabajo&&ie.inputError],onChangeText:t("ordenTrabajo"),onBlur:r("ordenTrabajo"),value:n.ordenTrabajo}),s.ordenTrabajo&&i.ordenTrabajo&&(0,m.jsx)(c.default,{style:ie.errorText,children:i.ordenTrabajo})]}),(0,m.jsxs)(l.default,{style:ie.inputGroup,children:[(0,m.jsx)(c.default,{style:ie.label,children:"Orden de suministro"}),(0,m.jsx)(O.default,{style:[ie.input,s.ordenSuministro&&i.ordenSuministro&&ie.inputError],onChangeText:t("ordenSuministro"),onBlur:r("ordenSuministro"),value:n.ordenSuministro}),s.ordenSuministro&&i.ordenSuministro&&(0,m.jsx)(c.default,{style:ie.errorText,children:i.ordenSuministro})]}),(0,m.jsxs)(l.default,{style:ie.inputGroup,children:[(0,m.jsx)(c.default,{style:ie.label,children:"Orden de concentraci\xf3n"}),(0,m.jsx)(O.default,{style:[ie.input,s.ordenConcentracion&&i.ordenConcentracion&&ie.inputError],onChangeText:t("ordenConcentracion"),onBlur:r("ordenConcentracion"),value:n.ordenConcentracion}),s.ordenConcentracion&&i.ordenConcentracion&&(0,m.jsx)(c.default,{style:ie.errorText,children:i.ordenConcentracion})]}),(0,m.jsxs)(l.default,{style:ie.inputGroup,children:[(0,m.jsx)(c.default,{style:ie.label,children:"Solicitud de componente"}),(0,m.jsx)(O.default,{style:[ie.input,s.solicitudComponente&&i.solicitudComponente&&ie.inputError],onChangeText:t("solicitudComponente"),onBlur:r("solicitudComponente"),value:n.solicitudComponente}),s.solicitudComponente&&i.solicitudComponente&&(0,m.jsx)(c.default,{style:ie.errorText,children:i.solicitudComponente})]}),(0,m.jsx)(z,{title:"Categor\xeda",onSelect:function(e){console.log("Categor\xeda seleccionada:",e),a("categoriaInfoFlightOrders",e)}}),s.categoriaInfoFlightOrders&&i.categoriaInfoFlightOrders&&(0,m.jsx)(c.default,{style:ie.errorText,children:i.categoriaInfoFlightOrders}),(0,m.jsx)(l.default,{style:ie.buttonContainer,children:(0,m.jsx)(p,{title:"Continuar",onPress:function(){console.log("Valores del formulario antes de enviar:",n),o()}})})]})}})})};var ue=r(484),ce=E.object().shape({grado:E.string().required("El grado es requerido").min(2,"El grado debe tener al menos 2 caracteres"),nombre:E.string().required("El nombre es requerido").min(2,"El nombre debe tener al menos 2 caracteres").matches(/^[A-Za-z\xc1\xe1\xc9\xe9\xcd\xed\xd3\xf3\xda\xfa\xd1\xf1\s]+$/,"El nombre solo debe contener letras y espacios"),matricula:E.string().required("La matr\xedcula es requerida").matches(/^[A-Z0-9-]+$/,"La matr\xedcula solo debe contener letras may\xfasculas, n\xfameros y guiones")}),de=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},formContainer:{width:"100%"},inputGroup:{marginBottom:15,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,borderRadius:4,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:5},signatureSection:{width:"100%",marginBottom:20},signaturePreview:{alignItems:"center",marginTop:10},signatureImage:{width:"100%",height:200,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:4},buttonContainer:{width:"100%",marginTop:20}});const fe=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)(),r=(0,n.useState)(null),o=(0,F.default)(r,2),a=o[0],i=o[1],f=(0,n.useState)(null),g=(0,F.default)(f,2),h=g[0],b=g[1],x=(0,n.useState)(null),v=(0,F.default)(x,2),C=v[0],S=v[1],T=(0,n.useState)(null),E=(0,F.default)(T,2),P=E[0],I=E[1],D=(0,n.useState)({grado:"",nombre:"",matricula:""}),B=(0,F.default)(D,2),A=B[0],k=B[1];(0,n.useEffect)((function(){var e,r;console.log("=== SignatureIssuing - useEffect ==="),console.log("Estado de navegaci\xf3n:",t.state),console.log("Estado original actual:",P),null!=(e=t.state)&&e.bitacoraId&&(console.log("BitacoraId recibido:",t.state.bitacoraId),b(t.state.bitacoraId)),null!=(r=t.state)&&r.signature&&(console.log("Firma recuperada del estado"),i(t.state.signature)),!P&&t.state&&(console.log("Guardando estado original"),I(t.state),t.state.formData?(console.log("Inicializando valores del formulario desde formData"),k(t.state.formData)):(t.state.grado||t.state.nombre||t.state.matricula)&&(console.log("Inicializando valores del formulario desde el estado original"),k({grado:t.state.grado||"",nombre:t.state.nombre||"",matricula:t.state.matricula||""})))}),[t.state,P]);var N=function(e){console.log("=== SignatureIssuing - handleSignatureComplete ==="),console.log("Firma recibida:",e?"Presente":"No presente"),e&&(console.log("Firma capturada:",e.substring(0,50)+"..."),i(e))},L=function(r){var o;console.log("=== SignatureIssuing - Navegando a SignaturePad ==="),console.log("Callback disponible:",null!=(o=t.state)&&o.onSignatureComplete?"S\xed":"No"),console.log("Estado original a mantener:",P),console.log("Valores del formulario a mantener:",r),e("/signature-pad",{state:{returnTo:"/signatureIssuing",bitacoraId:h,formData:r,onSignatureComplete:N}})},z=function(){var t=(0,u.default)((function*(t){if(console.log("=== SignatureIssuing - handleSubmit ==="),console.log("User Agent:",navigator.userAgent),console.log("Valores del formulario:",t),console.log("Imagen de firma:",a?"Presente":"No presente"),a&&(console.log("Longitud de la firma:",a.length),console.log("Primeros 100 caracteres de la firma:",a.substring(0,100)),console.log("\xbfBase64?",a.startsWith("data:image"))),console.log("BitacoraId a enviar:",h),console.log("Estado original a mantener:",P),h)if(a)try{var r=a;a&&a.startsWith("data:image")&&(r=a.split(",")[1]),console.log("Firma enviada al backend (primeros 100):",r?r.substring(0,100):"No hay firma");var o=yield fetch(`${j}/bitacora/signature-issuing`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grado:t.grado,nombre:t.nombre,matricula:t.matricula,firma:{data:r,type:"image/png"},bitacoraId:h})});console.log("Respuesta del servidor - Status:",o.status);var n=yield o.json();if(console.log("Respuesta del servidor - Data:",n),!o.ok)throw new Error(n.message||"Error al guardar la firma");e("/signatureDoer",{state:{bitacoraId:h}})}catch(C){console.error("Error al guardar los datos:",C),S(C.message)}else d.default.alert("Error","Por favor, capture su firma antes de continuar.");else S("No se encontr\xf3 el ID de la bit\xe1cora")}));return function(e){return t.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Datos de quien emite la bit\xe1cora"}),body:(0,m.jsxs)(l.default,{style:de.body,children:[C&&(0,m.jsx)(c.default,{style:de.errorText,children:C}),(0,m.jsx)(w.Formik,{initialValues:A,validationSchema:ce,onSubmit:z,enableReinitialize:!0,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,i=e.errors,s=e.touched;return(0,m.jsxs)(l.default,{style:de.formContainer,children:[(0,m.jsxs)(l.default,{style:de.inputGroup,children:[(0,m.jsx)(c.default,{style:de.label,children:"Grado*"}),(0,m.jsx)(O.default,{style:[de.input,i.grado&&s.grado&&de.inputError],onChangeText:t("grado"),onBlur:r("grado"),value:n.grado}),i.grado&&s.grado&&(0,m.jsx)(c.default,{style:de.errorText,children:i.grado})]}),(0,m.jsxs)(l.default,{style:de.inputGroup,children:[(0,m.jsx)(c.default,{style:de.label,children:"Nombre*"}),(0,m.jsx)(O.default,{style:[de.input,i.nombre&&s.nombre&&de.inputError],onChangeText:t("nombre"),onBlur:r("nombre"),value:n.nombre}),i.nombre&&s.nombre&&(0,m.jsx)(c.default,{style:de.errorText,children:i.nombre})]}),(0,m.jsxs)(l.default,{style:de.inputGroup,children:[(0,m.jsx)(c.default,{style:de.label,children:"Matr\xedcula*"}),(0,m.jsx)(O.default,{style:[de.input,i.matricula&&s.matricula&&de.inputError],onChangeText:t("matricula"),onBlur:r("matricula"),value:n.matricula}),i.matricula&&s.matricula&&(0,m.jsx)(c.default,{style:de.errorText,children:i.matricula})]}),(0,m.jsxs)(l.default,{style:de.signatureSection,children:[(0,m.jsx)(c.default,{style:de.label,children:"Firma*"}),a?(0,m.jsxs)(l.default,{style:de.signaturePreview,children:[(0,m.jsx)(ue.default,{source:{uri:a},style:de.signatureImage,resizeMode:"contain"}),(0,m.jsx)(p,{title:"Cambiar Firma",onPress:function(){return L(n)}})]}):(0,m.jsx)(p,{title:"Capturar Firma",onPress:function(){return L(n)}})]}),(0,m.jsx)(l.default,{style:de.buttonContainer,children:(0,m.jsx)(p,{title:"Guardar y Continuar",onPress:o,disabled:!a})})]})}})]})})};function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pe=E.object().shape({grado:E.string().required("El grado es requerido").min(2,"El grado debe tener al menos 2 caracteres"),nombre:E.string().required("El nombre es requerido").min(2,"El nombre debe tener al menos 2 caracteres").matches(/^[A-Za-z\xc1\xe1\xc9\xe9\xcd\xed\xd3\xf3\xda\xfa\xd1\xf1\s]+$/,"El nombre solo debe contener letras y espacios"),matricula:E.string().required("La matr\xedcula es requerida").matches(/^[A-Z0-9-]+$/,"La matr\xedcula solo debe contener letras may\xfasculas, n\xfameros y guiones"),mel:E.string().required("El MEL es requerido").min(2,"El MEL debe tener al menos 2 caracteres")}),he=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},formContainer:{width:"100%"},inputGroup:{marginBottom:15,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,borderRadius:4,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:5},signatureSection:{width:"100%",marginBottom:20},signaturePreview:{alignItems:"center",marginTop:10},signatureImage:{width:"100%",height:200,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:4},buttonContainer:{width:"100%",marginTop:20}});const be=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)(),r=(0,n.useState)(null),o=(0,F.default)(r,2),a=o[0],i=o[1],d=(0,n.useState)(null),f=(0,F.default)(d,2),g=f[0],h=f[1],b=(0,n.useState)(null),x=(0,F.default)(b,2),v=x[0],C=x[1],S=(0,n.useState)(null),T=(0,F.default)(S,2),E=T[0],P=T[1],I=(0,n.useState)({grado:"",nombre:"",matricula:"",mel:""}),D=(0,F.default)(I,2),B=D[0],A=D[1];(0,n.useEffect)((function(){console.log("=== SignatureDoer - useEffect ==="),console.log("Estado de navegaci\xf3n:",t.state),console.log("Estado original actual:",E),console.log("=== SignatureDoer - Debug Info ==="),console.log("URL actual:",window.location.pathname),console.log("Estado del componente:",{bitacoraId:g,signatureImage:a?"Presente":"No presente",error:v,initialFormValues:B}),t.state&&(t.state.bitacoraId&&(console.log("BitacoraId recibido:",t.state.bitacoraId),h(t.state.bitacoraId)),t.state.signature&&(console.log("Firma recibida del estado"),i(t.state.signature)),t.state.formData&&(console.log("Actualizando valores del formulario desde formData"),A(t.state.formData)),E||(console.log("Guardando estado original"),P(t.state)))}),[t.state,E,g,v,B,a]);var k=function(e){console.log("=== SignatureDoer - handleSignatureComplete ==="),console.log("Firma recibida:",e?"Presente":"No presente"),e&&(console.log("Firma capturada:",e.substring(0,50)+"..."),i(e))},N=function(r){var o;console.log("=== SignatureDoer - Navegando a SignaturePad ==="),console.log("Callback disponible:",null!=(o=t.state)&&o.onSignatureComplete?"S\xed":"No"),console.log("Estado original a mantener:",E),console.log("Valores del formulario a mantener:",r),e("/signature-pad",{state:{returnTo:"/signatureDoer",bitacoraId:g,formData:r,onSignatureComplete:k}})},L=function(){var t=(0,u.default)((function*(t){if(console.log("=== SignatureDoer - handleSubmit ==="),console.log("User Agent:",navigator.userAgent),console.log("Valores del formulario:",t),console.log("Imagen de firma:",a?"Presente":"No presente"),a&&(console.log("Longitud de la firma:",a.length),console.log("Primeros 100 caracteres de la firma:",a.substring(0,100)),console.log("\xbfBase64?",a.startsWith("data:image"))),console.log("BitacoraId a enviar:",g),console.log("Estado original a mantener:",E),g)if(a)try{var r=yield fetch(`${j}/bitacora/signature-doer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me(me({},t),{},{firma:{data:a,type:"image/png"},bitacoraId:g}))});console.log("Respuesta del servidor - Status:",r.status);var o=yield r.json();if(console.log("Respuesta del servidor - Data:",o),!r.ok)throw new Error(o.message||"Error al guardar la firma");console.log("=== SignatureDoer - Navegando a SignatureDelivery ==="),console.log("Estado a enviar:",me(me({},E),{},{bitacoraId:g,formData:t,signature:a})),e("/signatureDelivery",{state:{bitacoraId:g}})}catch(v){console.error("Error al guardar los datos:",v),C(v.message)}else C("La firma es requerida");else C("No se encontr\xf3 el ID de la bit\xe1cora")}));return function(e){return t.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Datos de quien realiz\xf3 las acciones"}),body:(0,m.jsxs)(l.default,{style:he.body,children:[v&&(0,m.jsx)(c.default,{style:he.errorText,children:v}),(0,m.jsx)(w.Formik,{initialValues:B,validationSchema:pe,onSubmit:L,enableReinitialize:!0,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,i=e.errors,s=e.touched;return(0,m.jsxs)(l.default,{style:he.formContainer,children:[(0,m.jsxs)(l.default,{style:he.inputGroup,children:[(0,m.jsx)(c.default,{style:he.label,children:"Grado*"}),(0,m.jsx)(O.default,{style:[he.input,i.grado&&s.grado&&he.inputError],onChangeText:t("grado"),onBlur:r("grado"),value:n.grado}),i.grado&&s.grado&&(0,m.jsx)(c.default,{style:he.errorText,children:i.grado})]}),(0,m.jsxs)(l.default,{style:he.inputGroup,children:[(0,m.jsx)(c.default,{style:he.label,children:"Nombre*"}),(0,m.jsx)(O.default,{style:[he.input,i.nombre&&s.nombre&&he.inputError],onChangeText:t("nombre"),onBlur:r("nombre"),value:n.nombre}),i.nombre&&s.nombre&&(0,m.jsx)(c.default,{style:he.errorText,children:i.nombre})]}),(0,m.jsxs)(l.default,{style:he.inputGroup,children:[(0,m.jsx)(c.default,{style:he.label,children:"Matr\xedcula*"}),(0,m.jsx)(O.default,{style:[he.input,i.matricula&&s.matricula&&he.inputError],onChangeText:t("matricula"),onBlur:r("matricula"),value:n.matricula}),i.matricula&&s.matricula&&(0,m.jsx)(c.default,{style:he.errorText,children:i.matricula})]}),(0,m.jsxs)(l.default,{style:he.inputGroup,children:[(0,m.jsx)(c.default,{style:he.label,children:"MEL (Lista de Equipo m\xednimo)*"}),(0,m.jsx)(O.default,{style:[he.input,i.mel&&s.mel&&he.inputError],onChangeText:t("mel"),onBlur:r("mel"),value:n.mel}),i.mel&&s.mel&&(0,m.jsx)(c.default,{style:he.errorText,children:i.mel})]}),(0,m.jsx)(l.default,{style:he.signatureSection,children:a?(0,m.jsxs)(l.default,{style:he.signaturePreview,children:[(0,m.jsx)(ue.default,{source:{uri:a},style:he.signatureImage,resizeMode:"contain"}),(0,m.jsx)(p,{title:"Cambiar Firma",onPress:function(){return N(n)}})]}):(0,m.jsx)(p,{title:"Capturar Firma",onPress:function(){return N(n)}})}),(0,m.jsx)(l.default,{style:he.buttonContainer,children:(0,m.jsx)(p,{title:"Guardar y Continuar",onPress:o,disabled:!a})})]})}})]})})};function ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var je=E.object().shape({grado:E.string().required("El grado es requerido").min(2,"El grado debe tener al menos 2 caracteres"),nombre:E.string().required("El nombre es requerido").min(2,"El nombre debe tener al menos 2 caracteres").matches(/^[A-Za-z\xc1\xe1\xc9\xe9\xcd\xed\xd3\xf3\xda\xfa\xd1\xf1\s]+$/,"El nombre solo debe contener letras y espacios"),matricula:E.string().required("La matr\xedcula es requerida").matches(/^[A-Z0-9-]+$/,"La matr\xedcula solo debe contener letras may\xfasculas, n\xfameros y guiones")}),ve=a.default.create({body:{flex:1,justifyContent:"center",alignItems:"center",width:"80%"},formContainer:{width:"100%"},inputGroup:{marginBottom:15,width:"100%"},label:{textAlign:"left",marginBottom:5},input:{height:40,borderColor:"gray",borderWidth:1,borderRadius:4,paddingLeft:8,width:"100%"},inputError:{borderColor:"red"},errorText:{color:"red",fontSize:12,marginTop:5},signatureSection:{width:"100%",marginBottom:20},signaturePreview:{alignItems:"center",marginTop:10},signatureImage:{width:"100%",height:200,marginBottom:10,borderWidth:1,borderColor:"gray",borderRadius:4},buttonContainer:{width:"100%",marginTop:20}});const Ce=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)(),r=(0,n.useState)(null),o=(0,F.default)(r,2),a=o[0],i=o[1],d=(0,n.useState)(null),f=(0,F.default)(d,2),g=f[0],h=f[1],b=(0,n.useState)(null),x=(0,F.default)(b,2),v=x[0],C=x[1],S=(0,n.useState)({grado:"",nombre:"",matricula:""}),T=(0,F.default)(S,2),E=T[0],P=T[1];(0,n.useEffect)((function(){console.log("=== SignatureDelivery - useEffect ==="),console.log("Estado de navegaci\xf3n:",t.state),t.state&&(t.state.bitacoraId&&(console.log("BitacoraId recibido:",t.state.bitacoraId),h(t.state.bitacoraId)),t.state.signature&&(console.log("Firma recibida del estado"),i(t.state.signature)),t.state.formData&&(console.log("Actualizando valores del formulario desde formData"),P(t.state.formData)))}),[t.state]);var I=function(e){console.log("=== SignatureDelivery - handleSignatureComplete ==="),console.log("Firma recibida:",e?"Presente":"No presente"),e&&(console.log("Firma capturada:",e.substring(0,50)+"..."),i(e))},D=function(r){var o;console.log("=== SignatureDelivery - Navegando a SignaturePad ==="),console.log("Callback disponible:",null!=(o=t.state)&&o.onSignatureComplete?"S\xed":"No"),console.log("Valores del formulario a mantener:",r),e("/signature-pad",{state:{returnTo:"/signatureDelivery",bitacoraId:g,formData:r,onSignatureComplete:I}})},B=function(){var t=(0,u.default)((function*(t){if(console.log("=== SignatureDelivery - handleSubmit ==="),console.log("User Agent:",navigator.userAgent),console.log("Valores del formulario:",t),console.log("Imagen de firma:",a?"Presente":"No presente"),a&&(console.log("Longitud de la firma:",a.length),console.log("Primeros 100 caracteres de la firma:",a.substring(0,100)),console.log("\xbfBase64?",a.startsWith("data:image"))),console.log("BitacoraId a enviar:",g),g)if(a)try{var r=yield fetch(`${j}/bitacora/signature-delivery`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe(xe({},t),{},{firma:{data:a,type:"image/png"},bitacoraId:g}))});console.log("Respuesta del servidor - Status:",r.status);var o=yield r.json();if(console.log("Respuesta del servidor - Data:",o),!r.ok)throw new Error(o.message||"Error al guardar la firma");console.log("=== SignatureDelivery - Navegando a Comments ==="),console.log("Estado a enviar:",{bitacoraId:g}),e("/comments",{state:{bitacoraId:g}})}catch(v){console.error("Error al guardar los datos:",v),C(v.message)}else C("La firma es requerida");else C("No se encontr\xf3 el ID de la bit\xe1cora")}));return function(e){return t.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Datos de quien entrega aeronave"}),body:(0,m.jsxs)(l.default,{style:ve.body,children:[v&&(0,m.jsx)(c.default,{style:ve.errorText,children:v}),(0,m.jsx)(w.Formik,{initialValues:E,validationSchema:je,onSubmit:B,enableReinitialize:!0,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values,i=e.errors,s=e.touched;return(0,m.jsxs)(l.default,{style:ve.formContainer,children:[(0,m.jsxs)(l.default,{style:ve.inputGroup,children:[(0,m.jsx)(c.default,{style:ve.label,children:"Grado*"}),(0,m.jsx)(O.default,{style:[ve.input,i.grado&&s.grado&&ve.inputError],onChangeText:t("grado"),onBlur:r("grado"),value:n.grado}),i.grado&&s.grado&&(0,m.jsx)(c.default,{style:ve.errorText,children:i.grado})]}),(0,m.jsxs)(l.default,{style:ve.inputGroup,children:[(0,m.jsx)(c.default,{style:ve.label,children:"Nombre*"}),(0,m.jsx)(O.default,{style:[ve.input,i.nombre&&s.nombre&&ve.inputError],onChangeText:t("nombre"),onBlur:r("nombre"),value:n.nombre}),i.nombre&&s.nombre&&(0,m.jsx)(c.default,{style:ve.errorText,children:i.nombre})]}),(0,m.jsxs)(l.default,{style:ve.inputGroup,children:[(0,m.jsx)(c.default,{style:ve.label,children:"Matr\xedcula*"}),(0,m.jsx)(O.default,{style:[ve.input,i.matricula&&s.matricula&&ve.inputError],onChangeText:t("matricula"),onBlur:r("matricula"),value:n.matricula}),i.matricula&&s.matricula&&(0,m.jsx)(c.default,{style:ve.errorText,children:i.matricula})]}),(0,m.jsxs)(l.default,{style:ve.signatureSection,children:[(0,m.jsx)(c.default,{style:ve.label,children:"Firma*"}),a?(0,m.jsxs)(l.default,{style:ve.signaturePreview,children:[(0,m.jsx)(ue.default,{source:{uri:a},style:ve.signatureImage,resizeMode:"contain"}),(0,m.jsx)(p,{title:"Cambiar Firma",onPress:function(){return D(n)}})]}):(0,m.jsx)(p,{title:"Capturar Firma",onPress:function(){return D(n)}})]}),(0,m.jsx)(l.default,{style:ve.buttonContainer,children:(0,m.jsx)(p,{title:"Guardar y Continuar",onPress:o,disabled:!a})})]})}})]})})};var Se=r(3177),Te=a.default.create({container:{flex:1,alignItems:"center",justifyContent:"center",width:"100%"},canvas:{borderWidth:1,borderColor:"#ccc",borderRadius:4,backgroundColor:"#fff"},buttonContainer:{flexDirection:"row",marginTop:20,gap:10},button:{padding:8,backgroundColor:"#414BB2",borderRadius:4,minWidth:100,alignItems:"center"},buttonText:{color:"white",fontSize:16}});const Oe=function(e){var t=e.onSave,r=e.onClear,o=(0,n.useRef)(null),a=(0,n.useRef)(!1),i=(0,n.useRef)(0),s=(0,n.useRef)(0);(0,n.useEffect)((function(){var e=o.current,t=e.getContext("2d");t.strokeStyle="#000000",t.lineWidth=2,t.lineCap="round",t.lineJoin="round";var r=function(t){a.current=!0;var r=e.getBoundingClientRect();i.current=t.clientX-r.left,s.current=t.clientY-r.top},n=function(r){if(a.current){var o=e.getBoundingClientRect(),n=r.clientX-o.left,l=r.clientY-o.top;t.beginPath(),t.moveTo(i.current,s.current),t.lineTo(n,l),t.stroke(),i.current=n,s.current=l}},l=function(){a.current=!1},u=function(t){t.preventDefault();var r=t.touches[0],o=e.getBoundingClientRect();i.current=r.clientX-o.left,s.current=r.clientY-o.top,a.current=!0},c=function(r){if(r.preventDefault(),a.current){var o=r.touches[0],n=e.getBoundingClientRect(),l=o.clientX-n.left,u=o.clientY-n.top;t.beginPath(),t.moveTo(i.current,s.current),t.lineTo(l,u),t.stroke(),i.current=l,s.current=u}},d=function(){a.current=!1};return e.addEventListener("mousedown",r),e.addEventListener("mousemove",n),e.addEventListener("mouseup",l),e.addEventListener("touchstart",u),e.addEventListener("touchmove",c),e.addEventListener("touchend",d),function(){e.removeEventListener("mousedown",r),e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",l),e.removeEventListener("touchstart",u),e.removeEventListener("touchmove",c),e.removeEventListener("touchend",d)}}),[]);return(0,m.jsxs)(l.default,{style:Te.container,children:[(0,m.jsx)("canvas",{ref:o,width:300,height:200,style:Te.canvas}),(0,m.jsxs)(l.default,{style:Te.buttonContainer,children:[(0,m.jsx)(f.default,{onPress:function(){var e=o.current;e.getContext("2d").clearRect(0,0,e.width,e.height),r()},style:Te.button,children:(0,m.jsx)(c.default,{style:Te.buttonText,children:"Limpiar"})}),(0,m.jsx)(f.default,{onPress:function(){var e=o.current.toDataURL("image/png");t(e)},style:Te.button,children:(0,m.jsx)(c.default,{style:Te.buttonText,children:"Guardar"})})]})]})};function we(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}var Ee=a.default.create({container:{flex:1,width:"100%"},signatureContainer:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?we(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({flex:1,width:"100%",height:300,backgroundColor:"#fff",borderRadius:4},void 0),buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:20,paddingHorizontal:20},clearButton:{backgroundColor:"#FF3B30"}});const Pe=function(e){var t=e.onSave,r=e.isWeb,o=(0,n.useRef)(null),a=function(e){console.log("=== SignaturePad - handleSave ==="),console.log("Firma guardada:",e?"Presente":"No presente"),t(e)};return r?(0,m.jsx)(Oe,{onSave:a}):(0,m.jsxs)(l.default,{style:Ee.container,children:[(0,m.jsx)(l.default,{style:Ee.signatureContainer,children:(0,m.jsx)(Se.default,{ref:o,onOK:a,onEmpty:function(){return a(null)},descriptionText:"Firma",clearText:"Limpiar",confirmText:"Guardar",webStyle:"\n            .m-signature-pad--body {\n              border: 1px solid #e8e8e8;\n              border-radius: 4px;\n            }\n            .m-signature-pad--footer {\n              display: flex;\n              flex-direction: row;\n              justify-content: space-between;\n              padding: 10px;\n            }\n            .button {\n              padding: 10px 20px;\n              border-radius: 4px;\n              background-color: #007AFF;\n              color: white;\n              border: none;\n              cursor: pointer;\n            }\n            .button.clear {\n              background-color: #FF3B30;\n            }\n          ",androidStyle:"\n            .m-signature-pad--body {\n              border: 1px solid #e8e8e8;\n              border-radius: 4px;\n            }\n            .m-signature-pad--footer {\n              display: flex;\n              flex-direction: row;\n              justify-content: space-between;\n              padding: 10px;\n            }\n            .button {\n              padding: 10px 20px;\n              border-radius: 4px;\n              background-color: #007AFF;\n              color: white;\n              border: none;\n            }\n            .button.clear {\n              background-color: #FF3B30;\n            }\n          ",iosStyle:"\n            .m-signature-pad--body {\n              border: 1px solid #e8e8e8;\n              border-radius: 4px;\n            }\n            .m-signature-pad--footer {\n              display: flex;\n              flex-direction: row;\n              justify-content: space-between;\n              padding: 10px;\n            }\n            .button {\n              padding: 10px 20px;\n              border-radius: 4px;\n              background-color: #007AFF;\n              color: white;\n              border: none;\n            }\n            .button.clear {\n              background-color: #FF3B30;\n            }\n          "})}),!1]})};function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Be=a.default.create({container:{flex:1,padding:20,backgroundColor:"#fff"},title:{fontSize:24,fontWeight:"bold",textAlign:"center",marginBottom:20},card:De({backgroundColor:"#fff",borderRadius:8,padding:15,marginBottom:20},{boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.25)"}),buttonContainer:{alignItems:"center",marginTop:20}});const Ae=function(){var e=(0,s.useNavigate)(),t=(0,s.useLocation)(),r=(0,n.useState)(null),o=(0,F.default)(r,2),a=o[0],i=o[1],u=(0,n.useState)(!0),d=(0,F.default)(u,1)[0];(0,n.useEffect)((function(){console.log("=== SignaturePadPage - useEffect ==="),console.log("Estado de navegaci\xf3n:",t.state),console.log("Plataforma:","web")}),[t.state]);return(0,m.jsxs)(l.default,{style:Be.container,children:[(0,m.jsx)(c.default,{style:Be.title,children:"Captura de Firma"}),(0,m.jsx)(l.default,{style:Be.card,children:(0,m.jsx)(Pe,{onSave:function(e){console.log("=== SignaturePadPage - handleSaveSignature ==="),console.log("Firma guardada exitosamente"),console.log("Estado de la firma:",e?"Presente":"No presente"),i(e)},isWeb:d})}),(0,m.jsx)(l.default,{style:Be.buttonContainer,children:(0,m.jsx)(p,{title:"Finalizar Firma",onPress:function(){var r,o,n,l,i;console.log("=== SignaturePadPage - handleFinish ==="),console.log("Intentando finalizar firma..."),console.log("Estado de la firma:",a?"Presente":"No presente"),console.log("Callback disponible:",null!=(r=t.state)&&r.onSignatureComplete?"S\xed":"No"),console.log("Estado completo:",t.state),a&&null!=(o=t.state)&&o.onSignatureComplete&&(console.log("Ejecutando callback con la firma..."),t.state.onSignatureComplete(a)),console.log("Navegando a la p\xe1gina anterior..."),e((null==(n=t.state)?void 0:n.returnTo)||"/",{state:De(De({},t.state),{},{signature:a,bitacoraId:null==(l=t.state)?void 0:l.bitacoraId,formData:null==(i=t.state)?void 0:i.formData})})},disabled:!a})})]})};var Fe=a.default.create({body:{flex:1,justifyContent:"space-between",alignItems:"center",width:"100%",height:"100%"},textareaContainer:{width:"80%",height:"70%",marginVertical:20},textarea:{width:"100%",height:"100%",borderColor:"gray",borderWidth:1,borderRadius:4,padding:10,fontSize:16,backgroundColor:"white"},buttonContainer:{width:"80%",marginTop:20,marginBottom:20}});const ke=function(){var e=(0,s.useNavigate)(),t=((0,s.useLocation)().state||{}).bitacoraId,r=function(){var r=(0,u.default)((function*(r){try{if(!t)return void d.default.alert("Error","No se encontr\xf3 el ID de la bit\xe1cora");if(!(yield fetch(`${j}/bitacora/id/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Error al actualizar los comentarios");var o=yield fetch(`${j}/bitacora/${t}/export-excel`,{method:"POST"});if(!o.ok)throw new Error("Error al exportar a Excel");var n=yield o.blob(),a=window.URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=`BITACORA-${t}.xlsx`,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(a),document.body.removeChild(l);var i=yield fetch(`${j}/bitacora/reset-db`,{method:"POST"});if(!i.ok)throw new Error("Error al limpiar la base de datos");var s=yield i.json();console.log("Respuesta de limpieza de base de datos:",s),d.default.alert("\xc9xito","Bit\xe1cora exportada y base de datos limpiada exitosamente"),e("/")}catch(u){console.error("Error:",u),d.default.alert("Error",u.message||"Hubo un problema al procesar la solicitud")}}));return function(e){return r.apply(this,arguments)}}();return(0,m.jsx)(R,{header:(0,m.jsx)(y,{titleName:"Observaciones y/o comentarios"}),body:(0,m.jsx)(w.Formik,{initialValues:{comments:""},onSubmit:r,children:function(e){var t=e.handleChange,r=e.handleBlur,o=e.handleSubmit,n=e.values;return(0,m.jsxs)(l.default,{style:Fe.body,children:[(0,m.jsx)(l.default,{style:Fe.textareaContainer,children:(0,m.jsx)(O.default,{style:Fe.textarea,onChangeText:t("comments"),onBlur:r("comments"),value:n.comments,multiline:!0,numberOfLines:20,placeholder:"Ingrese sus observaciones o comentarios aqu\xed...",textAlignVertical:"top"})}),(0,m.jsx)(l.default,{style:Fe.buttonContainer,children:(0,m.jsx)(p,{title:"Imprimir",onPress:o})})]})}})})};var Ne=r(7109);function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){(0,T.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ze=a.default.create({container:{flex:1,padding:16,backgroundColor:"#fff"},title:{fontSize:24,fontWeight:"bold",marginBottom:20,textAlign:"center"},formGroup:{marginBottom:16},label:{fontSize:16,marginBottom:8,fontWeight:"500"},input:{borderWidth:1,borderColor:"#ddd",borderRadius:8,padding:12,fontSize:16},readOnlyInput:{backgroundColor:"#f5f5f5",color:"#666"},textArea:{height:100,textAlignVertical:"top"},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:20},button:{padding:12,borderRadius:8,minWidth:150,alignItems:"center"},cancelButton:{backgroundColor:"#e0e0e0"},submitButton:{backgroundColor:"#3b82f6"},buttonText:{color:"#fff",fontSize:16,fontWeight:"500"},errorContainer:{backgroundColor:"#fee2e2",borderColor:"#f87171",borderWidth:1,borderRadius:8,padding:12,marginBottom:16},errorText:{color:"#dc2626",fontSize:14},successContainer:{backgroundColor:"#dcfce7",borderColor:"#4ade80",borderWidth:1,borderRadius:8,padding:12,marginBottom:16},successText:{color:"#16a34a",fontSize:14}});const Ge=function(){var e=(0,s.useParams)().folio,t=(0,s.useNavigate)(),r=(0,n.useState)({folio:"",fecha:"",hora:"",tipo:"",descripcion:"",correccion:""}),o=(0,F.default)(r,2),a=o[0],i=o[1],d=(0,n.useState)(""),g=(0,F.default)(d,2),p=g[0],h=g[1],b=(0,n.useState)(""),y=(0,F.default)(b,2),x=y[0],j=y[1];(0,n.useEffect)((function(){var t=function(){var t=(0,u.default)((function*(){try{var t=(yield Ne.default.get(`https://bitacoraapp.onrender.com/api/bitacoras/${e}`)).data;i({folio:t.folio,fecha:t.fecha,hora:t.hora,tipo:t.tipo,descripcion:t.descripcion,correccion:""})}catch(p){console.error("Error fetching bitacora:",p),h("Error al cargar los datos de la bit\xe1cora")}}));return function(){return t.apply(this,arguments)}}();t()}),[e]);var v=function(){var r=(0,u.default)((function*(){if(h(""),j(""),a.correccion.trim())try{yield Ne.default.patch(`http://localhost:3001/api/bitacora/${e}/correcciones`,{correccion:a.correccion,usuario:"Usuario"});j("Correcci\xf3n agregada exitosamente"),setTimeout((function(){t("/")}),2e3)}catch(p){var r,o;console.error("Error submitting correction:",p),h((null==(r=p.response)||null==(o=r.data)?void 0:o.error)||"Error al guardar la correcci\xf3n")}else h("La correcci\xf3n es requerida")}));return function(){return r.apply(this,arguments)}}();return(0,m.jsxs)(k.default,{style:ze.container,children:[(0,m.jsx)(c.default,{style:ze.title,children:"Agregar Correcci\xf3n"}),p?(0,m.jsx)(l.default,{style:ze.errorContainer,children:(0,m.jsx)(c.default,{style:ze.errorText,children:p})}):null,x?(0,m.jsx)(l.default,{style:ze.successContainer,children:(0,m.jsx)(c.default,{style:ze.successText,children:x})}):null,(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Folio"}),(0,m.jsx)(O.default,{style:[ze.input,ze.readOnlyInput],value:a.folio,editable:!1})]}),(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Fecha"}),(0,m.jsx)(O.default,{style:[ze.input,ze.readOnlyInput],value:a.fecha,editable:!1})]}),(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Hora"}),(0,m.jsx)(O.default,{style:[ze.input,ze.readOnlyInput],value:a.hora,editable:!1})]}),(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Tipo"}),(0,m.jsx)(O.default,{style:[ze.input,ze.readOnlyInput],value:a.tipo,editable:!1})]}),(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Descripci\xf3n"}),(0,m.jsx)(O.default,{style:[ze.input,ze.readOnlyInput,ze.textArea],value:a.descripcion,editable:!1,multiline:!0})]}),(0,m.jsxs)(l.default,{style:ze.formGroup,children:[(0,m.jsx)(c.default,{style:ze.label,children:"Correcci\xf3n"}),(0,m.jsx)(O.default,{style:[ze.input,ze.textArea],value:a.correccion,onChangeText:function(e){return t="correccion",r=e,i((function(e){return Le(Le({},e),{},(0,T.default)({},t,r))})),void h("");var t,r},placeholder:"Ingrese la correcci\xf3n...",multiline:!0})]}),(0,m.jsxs)(l.default,{style:ze.buttonContainer,children:[(0,m.jsx)(f.default,{style:[ze.button,ze.cancelButton],onPress:function(){return t("/")},children:(0,m.jsx)(c.default,{style:ze.buttonText,children:"Cancelar"})}),(0,m.jsx)(f.default,{style:[ze.button,ze.submitButton],onPress:v,children:(0,m.jsx)(c.default,{style:ze.buttonText,children:"Guardar Correcci\xf3n"})})]})]})};var qe=a.default.create({container:{paddingTop:40,backgroundColor:"white",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:10},titleContainer:{flex:.9,alignItems:"flex-end"},iconContainer:{flex:.1,alignItems:"flex-end",marginTop:10},title:{color:"black",fontSize:20,fontWeight:"bold"}});const Ve=function(){return(0,m.jsxs)(l.default,{style:qe.container,children:[(0,m.jsx)(l.default,{style:qe.iconContainer,children:(0,m.jsxs)(c.default,{children:[(0,m.jsx)(x.default,{name:"home",size:25,color:"black"})," "]})}),(0,m.jsx)(l.default,{style:qe.titleContainer,children:(0,m.jsx)(i.Link,{to:"/",component:f.default,children:(0,m.jsx)(c.default,{style:qe.title,children:"Bit\xe1cora App"})})})]})};const We=function(){return(0,m.jsxs)(i.NativeRouter,{children:[(0,m.jsx)(Ve,{}),(0,m.jsxs)(s.Routes,{children:[(0,m.jsx)(s.Route,{path:"/",element:(0,m.jsx)(S,{})}),(0,m.jsx)(s.Route,{path:"/newBitacora",element:(0,m.jsx)(A,{})}),(0,m.jsx)(s.Route,{path:"/InfoFlight",element:(0,m.jsx)(_,{})}),(0,m.jsx)(s.Route,{path:"/InfoFlightPt2",element:(0,m.jsx)(ee,{})}),(0,m.jsx)(s.Route,{path:"/InfoFlightComponents",element:(0,m.jsx)(oe,{})}),(0,m.jsx)(s.Route,{path:"/InfoFlightOrders",element:(0,m.jsx)(se,{})}),(0,m.jsx)(s.Route,{path:"/signatureIssuing",element:(0,m.jsx)(fe,{})}),(0,m.jsx)(s.Route,{path:"/signatureDoer",element:(0,m.jsx)(be,{})}),(0,m.jsx)(s.Route,{path:"/signatureDelivery",element:(0,m.jsx)(Ce,{})}),(0,m.jsx)(s.Route,{path:"/signature-pad",element:(0,m.jsx)(Ae,{})}),(0,m.jsx)(s.Route,{path:"/comments",element:(0,m.jsx)(ke,{})}),(0,m.jsx)(s.Route,{path:"/correccion/:folio",element:(0,m.jsx)(Ge,{})})]})]})};function Me(){return(0,m.jsxs)(l.default,{style:$e.container,children:[(0,m.jsx)(We,{}),(0,m.jsx)(o.StatusBar,{style:"auto"})]})}var $e=a.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center"}})}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.m=e,(()=>{var e=[];r.O=(t,o,n,a)=>{if(!o){var l=1/0;for(c=0;c<e.length;c++){for(var[o,n,a]=e[c],i=!0,s=0;s<o.length;s++)(!1&a||l>=a)&&Object.keys(r.O).every((e=>r.O[e](o[s])))?o.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,n,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"===typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"===typeof o.then)return o}var a=Object.create(null);r.r(a);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&o;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>l[e]=()=>o[e]));return l.default=()=>o,r.d(a,l),a}})(),r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/BITACORAAPP/",(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[l,i,s]=o,u=0;if(l.some((t=>0!==e[t]))){for(n in i)r.o(i,n)&&(r.m[n]=i[n]);if(s)var c=s(r)}for(t&&t(o);u<l.length;u++)a=l[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=r.O(void 0,[675],(()=>r(5036)));o=r.O(o)})();
//# sourceMappingURL=main.13818b5f.js.map